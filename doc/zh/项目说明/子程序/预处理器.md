# 预处理器  

预处理器是`oloc`在执行运算时的第一个子程序,负责将输入的表达式进行一些预处理操作,以便之后的步骤使用.  
预处理器位于`preprocessor.py`.  
预处理器实例于`Preprocessor`类.  

## 输入输出  

预处理器接受一个参数.  

- `expression`:`str` 输入的表达式  

预处理器的处理结果存储在`expression`属性中.    

## 工作流  

预处理器按顺序依次执行如下内容.  

1. ***注释去除***  
   - **功能**  
      - 移除输入的表达式中的注释  
   - **实现**  
      - 检测`@`后的内容,移除结尾注释  
      - 检测`#`包裹的内容,移除自由注释  
   - **示例**  
      - *输入*: `1 + #note# 1 @注释`  
      - *输出*: `1 +  1`
   - **异常**  
      - `OlocCommentException`: 当`#`不匹配时  
2. ***符号映射***  
   - **功能**  
      - 根据[符号映射表](../数据/符号映射表.md)进行符号替换  
   - **实现**  
      - 使用`simpsave`从`olocconfig.ini`中读取符号映射表和并处理函数名称表至内存中  
      - 标注函数名称表中保留的函数名和自定义长无理数的下标,并标注为保护  
      - 根据读取的字典,对非保护位依次进行符号替换    
      > 由于字典有序性限制,`oloc`需要`python >= 3.7` 
   - **示例**  
      - *输入*: `_2 / 3**2 加 5^o × 4p =`  
      - *输出*: `2/3^2+5°×4π`  

---
***[点此](../项目说明梗概.md)跳转回说明梗概页面***  
