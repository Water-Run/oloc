# 词法分析器  

预处理器是`oloc`在执行运算时的第二个子程序,负责将输入的表达式进行分词,并执行静态检查.  
词法分析器实例于`Lexer`类.  

## 关于`Token`  

类`Token`是词法分析的一个基本单元.  
`Token`的类别是其的子枚举`TYPE`.`Token`被分类为以下类别:  
1. 有理数类型  
    - 整数型: `INTEGER`  
    - 有限小数型: `FINITE_DECIMAL`  
    - 无限循环小数型: `INFINITE_DECIMAL`  
    - 分数型: `FINITE_DECIMAL`  
    - 百分数型:`PERCENTAGE`  
    - 带分数型:`MIXED_FRACTION`  
2. 无理数类型  
    - 原生无理数: `NATIVE_IRRATIONAL`  
    - 短自定义无理数: `SHORT_CUSTOM`  
    - 长自定义无理数: `LONG_CUSTOM`  
3. 运算符型  
    - 非分组运算符: `OPERATOR`  
    - 左括号: `LBRACKET`  
    - 右括号: `RBRACKET`  
4. 函数相关  
    - 函数: `FUNCTION`  
    - 函数分隔符: `PARAM_SEPARATOR`  
5. 未知  
    - 未知(异常时): `UNKNOWN`  

> 关于类别的详细内容, 见[数字](../../使用教程/数字.md),[运算符](../../使用教程/运算符.md)和[函数](../../使用教程/函数.md)  

`Token`具备如下属性:  

- `type`:`TYPE` `Token`的类型  
- `range`:`list[int, int]` `Token`在(构造它的)表达式中的范围(`[前下标,后下标]`)  
- `value`:`str` `Token`的值,及其对应的具体子表达式  
- `is_legal`:`bool` 该`Token`是否合法.在`Token`实例化时,会自动进行检测  

## 静态方法  

词法分析器提供了以下的静态方法.这些方法在预处理器和词法分析器自身中被调用.  

### `Lexer`中的静态方法  

`Lexer`中的静态方法主要是通用的`Token`处理(及表达式生成)相关的内容.  

## 输入输出  

词法分析器接受一个参数.  

- `expression`:`str` 输入的表达式  

词法分析器的返回值为`list[Token]`,即分词后的Token列表.其中,类`Token`包含以下属性:  

- `token_type`:`TYPE` Token的类别.其中,`TYPE`是`Token`内置的一个字符串枚举  
- `token_range`:`list[int, int]` Token在表达式中的位置.整数列表的第一个参数是开始的下标,第二个则是结束的下标  
- `value`:`str | None` Token的值(即表达式中的原文)  

## 工作流  

词法分析器按顺序依次执行如下内容.  