# 数字  

`oloc`核心为**分数形式的数字运算**,以保证最高的精确度.`oloc`的运算支持涵盖实数集,即支持有理数和无理数的混合运算.  
在数字前加入一个`-`(负号),将表明该数字为负数.同样的也可以在数字前加入一个`+`显示的声明该数字为正数--尽管没什么意义.  

## 有理数  

有理数是`oloc`的核心数字类型.任何有理数在计算的预处理过程中都会被转换为真分数形式.不过,支持的输入类型是多样的.  

### 整数  

**整数指由单纯的阿拉伯数字及一个可选的`+`或`-`构成的数**.  
以下是一些整数示例:  
`0`,`1`,`-1`,`15`,`+100`  

### 分数  

**分数包含整数形式的分子和分母(不可为0)**.对于分数的正负号,一般建议将`-`放置在分子前以便阅读.以下是一些分数示例:  
`1/2`,`0/10`,`-314/222`,`+50/-100`
在计算中`oloc`将自动转化分数最简形式,即真分数形式.同时将正/负号化简(如果分子分母同时出现)且移至分子.例如,`2/-4`将被化简为`-1/2`.  

> `oloc`也兼容带分数.使用整数和符号`\`后的分数表示.例如,`3\1/2`表示`3+1/2`,即`7/2.注意`\`后面的分数不能包含正负符号,否则将导致解析异常  

### 小数

**小数指由整数位和小数位构成的数**.其中,整数位和小数位使用`.`隔开.小数也可以添加一个可选的`-`在开头.  

一些小数示例:
`0.25`,`3.14`,`10500.12345`,`-0.0001`  

> `oloc`也兼容无限循环小数.使用3至6个`.`添加到小数结尾表明这是一个无限循环小数.例如,`2.3...`,`123.123......`  
>> `oloc`会自动扫描最近重复的结构,并转化为分数形式表示  
> 也可以显式的指出循环部分:在小数的结尾,添加上以`:`开头的需要循环的小数部分.如`1.2:3`等价于`1.23...`  

#### 百分格式  

`oloc`也支持百分格式的数据.在数字结尾加上`%`即可.  

> 百分格式的数字必须是整数或小数.如`100%`,`-0.5%`  

> 使用百分格式时,不能省略乘号,否则会被视为取余.如`50%(0.1+0.2)`将会视为求`0.5%0.3`  

### 数字分隔符  

对于较大的数字,可能在阅读时会产生一定的难度.例如,数字`10000000`(一亿)就是一个比较大的数字.一种方式是使用科学计数法: 比如,将如上数字表示为`1*10^7`.  
`oloc`也支持使用**数字分隔符**的形式.使用可以采用`,`,如`10,000,000`.对于具体间隔,`oloc`不做限制.  

> **在使用数字分隔符时,需要遵守以下限制**:  
> - 数字分隔符**必须用在有理数**中  
> - **数字分隔符不能出现在开头或结尾**.如`,100,000`  
> - **数字分隔符不能出现连续**.如`2,,000`  
> - **函数的参数使用了`,`作为数字分隔符时,函数的参数区分必须使用`;`而不是`,`**,避免出现解析异常  

## 无理数  

**`oloc`支持无理数**.无理数之间支持对应的运算,**如果最后的计算结果包含无理数,将会进行相应的保留**.如`1+π`  
一些函数的运算结果可能为无理数.对于这些**结果中的无理数,也会对应保留**.例如,`√1/2`.  

### 原生无理数

`oloc`原生支持的无理数包括**圆周率`π`**和**自然指数`𝑒`**.  
其中,`π`可写作`p`或`pi`,`𝑒`可写作`e`,及对应任意大小写形式.  

> 在**浮点转化(`float()`)时,默认对原生无理数保留7位小数**.例如,`π`的默认转化是`3.1415926`.也可以声明需要保留的位数,在无理数后`?`之前输入需要保留的位数即可.例如,`p2?`在进行转化后的值为`3.14`  
> > 默认的保留位数是可更改的:见[计算及异常](计算,结果及异常.md)关于`retain_decimal_places`部分内容  

### 自定义无理数  

事实上,**对于任何(不严谨,见下)单个字符,`oloc`都会将其视为无理数**,包括`x`,`y`,`z`,`值`等.在`oloc`中,我们将其称为**短自定义无理数**.  
> **不要将[符号映射表](../项目说明/数据/符号映射表.md)和[函数转换表](../项目说明/数据/函数转换表.md)中的保留字(表第二列的全部)用于自定义无理数**中(如`^o`中的`o`),避免表达式被错误替换预处理  

> 合理使用这点可以利用`oloc`表达未知量,进行化简运算.例如,`oloc.calculation('3x/5xy')`的结果为`3/5y`  

自定义无理数也可以支持多个单词:使用`<` `>`包裹即可,表示**长自定义无理数**,其内的名称不影响解析即可.例如,`<IR>`,`<An irrational number>`,`无理数`.  
> 为自定义无理数添加转化值或正负性:在无理数的结尾(对于长无理数,`>`之后)与`?`之间添加值(必须是有限小数或整数(可视为.0),即浮点数)或正负号即可.例如,`X-?`表示该无理数是负数,`<num>1.23?`表示该无理数的转化值为`1.23`  
> 示例:  
> ```python
> import oloc
> oloc.calculation('|x-?|') # Output: -x
> result = oloc.calculation('<num>1/2?') # Output: <num>1/2?
> print(float(result)) # Output: 1/2
> ```
> > 在调用绝对值函数或进行浮点转化时,为避免异常,进行对应的添加操作  

> 对于结果可能为无理数的值(如函数),也支持`?`表达式.例如,`pow(2,1/2)?3`表示以上函数结果的转化值(如果结果有无理数)为保留3位小数.对于使用转化为函数的运算符的函数也是如此  
> > 为避免意外的解析错误,可以在使用`?`时,可以为对应的表达式添加括号  

> 一个包含各种数字的表达式: `1+-2.5+2/3+<一个无理数>-2_1/3+pi+x+2.34...-0.5:5+(<number>+i/3i/500)`, 依次为*整数,有限小数,分数,自定义短无理数,带分数,原生无理数,自定义短无理数,无限循环小数,无限循环小数(显示指明),以及一个混合数*  

---  
***下一章节:[运算符](运算符.md)***  
*[返回目录](使用教程目录.md)*  